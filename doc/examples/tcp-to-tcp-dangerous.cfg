# rax25kb Configuration Example - TCP-to-TCP (DANGEROUS!)
# Copyright (C) 2025-2026 Kris Kirby, KE4AHR
# SPDX-License-Identifier: GPL-3.0-or-later
# Version: 1.6.7
#
# ⚠️⚠️⚠️ WARNING: DANGEROUS CONFIGURATION ⚠️⚠️⚠️
#
# TCP-to-TCP mode bypasses hardware serial port isolation!
# 
# ONLY USE IN:
# - Controlled lab environments
# - Trusted networks
# - When you fully understand the risks
#
# DO NOT USE:
# - In production environments
# - On internet-facing systems
# - Where security matters
#
# RISKS:
# - External systems can inject packets
# - No hardware rate limiting
# - Data corruption from format mismatches
# - Potential network loops
# - No authentication or encryption

# ============================================================================
# Example: Localhost-only TCP-to-TCP bridge (safest dangerous config)
# ============================================================================

# Server Side - Receives connections
cross_connect0000.tcp_mode=server
cross_connect0000.tcp_address=127.0.0.1           # LOCALHOST ONLY!
cross_connect0000.tcp_port=8001

# REQUIRED: Dangerous flag to enable TCP-to-TCP
cross_connect0000.tcp_to_tcp_dangerous=yes        # Required for TCP-to-TCP

# RECOMMENDED: Keep KISS validation enabled
cross_connect0000.tcp_to_tcp_also_dangerous=no    # Enforce KISS packets

# Client Side - Connects to another server
cross_connect0001.tcp_mode=client
cross_connect0001.tcp_server_address=127.0.0.1    # Connect to localhost
cross_connect0001.tcp_server_port=8002

# REQUIRED: Dangerous flag
cross_connect0001.tcp_to_tcp_dangerous=yes

# Global Settings
log_level=6                                        # Monitor warnings
logfile=/var/log/rax25kb-dangerous.log
log_to_console=yes                                 # See warnings immediately

# ============================================================================
# KISS Validation
# ============================================================================
#
# When tcp_to_tcp_also_dangerous=no (DEFAULT, RECOMMENDED):
# - Only KISS-framed packets allowed ([FEND]...[FEND])
# - Non-KISS packets rejected and logged
# - Provides minimal safety check
#
# When tcp_to_tcp_also_dangerous=yes (VERY DANGEROUS):
# - NO validation - all data passes through
# - Maximum danger
# - Only use if you absolutely know what you're doing

# ============================================================================
# Safer Alternatives to TCP-to-TCP
# ============================================================================
#
# Instead of TCP-to-TCP, consider:
# 1. Serial-to-TCP on both ends (traditional)
# 2. VPN tunnel between systems
# 3. SSH port forwarding
# 4. Separate rax25kb instances
# 5. Hardware serial connection

# ============================================================================
# Monitoring TCP-to-TCP
# ============================================================================
#
# Watch logs closely:
# tail -f /var/log/rax25kb-dangerous.log | grep "TCP-to-TCP\|dangerous\|rejected"
#
# Check for warnings:
# grep "WARNING" /var/log/rax25kb-dangerous.log
#
# Monitor connections:
# netstat -tulpn | grep rax25kb

# ============================================================================
# Firewall Protection (CRITICAL)
# ============================================================================
#
# If you must use TCP-to-TCP, add firewall rules:
#
# Linux (iptables):
# iptables -A INPUT -p tcp --dport 8001 -s 127.0.0.1 -j ACCEPT
# iptables -A INPUT -p tcp --dport 8001 -j DROP
#
# Linux (firewalld):
# firewall-cmd --permanent --add-rich-rule='rule family="ipv4" source address="127.0.0.1" port port="8001" protocol="tcp" accept'
# firewall-cmd --reload

# ============================================================================
# Testing Checklist
# ============================================================================
#
# Before using TCP-to-TCP in ANY environment:
# [ ] Understand all risks
# [ ] Have firewall rules in place
# [ ] Monitor logs actively
# [ ] Test in isolated network first
# [ ] Have kill switch ready
# [ ] Document configuration
# [ ] Inform team/users of risks
# [ ] Consider alternatives first

# ============================================================================
# Emergency Procedures
# ============================================================================
#
# If things go wrong:
# 1. Stop rax25kb: systemctl stop rax25kb
# 2. Check logs for issues
# 3. Block port: iptables -A INPUT -p tcp --dport 8001 -j DROP
# 4. Investigate before restarting
# 5. Consider removing TCP-to-TCP configuration

# ============================================================================
# YOU HAVE BEEN WARNED!
# ============================================================================
