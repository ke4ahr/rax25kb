RAX25KB
December 2024

NAME

rax25kb - AX.25 KISS protocol bridge for serial to TCP connections

SYNOPSIS

rax25kb [OPTIONS]

DESCRIPTION

rax25kb is a bridge application that connects a serial port running the
KISS (Keep It Simple Stupid) protocol to a TCP socket. It is designed
for amateur radio packet applications, allowing APRS and other AX.25
software to communicate with hardware TNCs (Terminal Node Controllers)
over TCP/IP.

The application supports both IPv4 and IPv6, can parse and display AX.25
frames, write packet captures to PCAP format, and includes the PhilFlag
correction for non-standard KISS implementations.

OPTIONS

Serial Port Options

-D, --device DEVICE

    Specify the serial port device. On Linux, this is typically
    /dev/ttyUSB0 or /dev/ttyACM0. On Windows, use COM3 or similar. This
    option overrides the serial_port configuration file setting.

-b, --baud-rate RATE

    Set the serial port baud rate. Common values are 1200, 9600, 19200,
    38400, and 115200. Default is 9600.

-s, --stop-bits 1|2

    Set the number of stop bits. KISS TNC default is 1. Values: 1 or 2.

-Q, --parity n|e|o

    Set parity checking. KISS TNC default is none. Values: n (none), e
    (even), o (odd).

Flow Control Options

-x, --xon-xoff

    Enable software flow control (XON/XOFF). Use this for older modems
    or devices that support software flow control.

-H, --rts-cts

    Enable hardware flow control (RTS/CTS). Use this for modern TNCs
    that support hardware flow control.

--dtr-dsr

    Enable DTR/DSR flow control. Primarily for Windows systems with
    devices that use Data Terminal Ready and Data Set Ready signals.

-N, --none

    Disable flow control (default). Use when no flow control is needed
    or supported.

Network Options

-I, --address ADDR

    Specify one or more TCP listener addresses, separated by spaces or
    commas. Examples: 0.0.0.0 (all IPv4 interfaces), 127.0.0.1
    (localhost only), :: (all IPv6 interfaces), ::1 (IPv6 localhost), or
    0.0.0.0 :: (both IPv4 and IPv6). Default is 0.0.0.0.

-p, --port PORT

    Set the TCP listening port. Default is 8001.

-4

    Listen on IPv4 addresses only. Filters out IPv6 addresses from the
    address list.

-6

    Listen on IPv6 addresses only. Filters out IPv4 addresses from the
    address list.

Feature Options

-d, --dump

    Dump KISS frames in xxd-like hexadecimal format. Shows the complete
    frame contents with both hex and ASCII representation.

-k, --kiss

    Parse and display KISS frame information. Shows the KISS command
    type, port number, and decoded AX.25 header information including
    callsigns with SSIDs.

-a, --ax25

    Dump AX.25 information fields in xxd-like format. When combined with
    -k, this displays the payload of AX.25 UI frames in human-readable
    hex dump format.

-n, --phil

    Enable PhilFlag correction. This flag applies corrections for
    hardware with TASCO modem chipset bugs:

    -   Serial -> TCP: Replace unescaped FEND bytes (0xC0) inside KISS
        frames with the proper escape sequence (0xDB 0xDC).

    -   TCP -> Serial: Escape 'C' (0x43) and 'c' (0x63) characters as
        (0xDB 0x43) and (0xDB 0x63) to prevent the radio from parsing
        "TC0\n" or "tc0\n" command sequences.

    Use this for hardware that doesn't properly implement KISS escaping
    or that misinterprets certain character sequences as commands.

-R, --raw-copy

    Enable raw copy mode (transparent pass-through). When enabled, all
    data is copied bidirectionally between TCP and serial without KISS
    frame processing. This mode is useful for:

    -   Direct terminal access to the TNC

    -   Non-KISS protocols

    -   Firmware updates

    -   TNC configuration

    Note: PhilFlag, frame parsing, and PCAP capture are disabled in raw
    copy mode.

Logging Options

-l, --logfile FILE

    Write log messages to the specified file. Logs include timestamps
    and severity levels.

-L, --log-level LEVEL

    Set the logging level from 0 (emergency) to 9 (verbose). Default is
    5 (notice). See LOG LEVELS section below.

--console-only

    Log only to the console. Disables file logging even if -l is
    specified.

--no-console

    Log only to the specified log file. Disables console output.

Output Options

--pcap FILE

    Write AX.25 frames to a PCAP (packet capture) file. The output can
    be opened in Wireshark for detailed protocol analysis. Only AX.25
    data frames (KISS command 0) are captured.

-P, --pidfile FILE

    Write the process ID to the specified file on startup. Useful for
    init scripts and process management.

General Options

-c FILE

    Use the specified configuration file instead of the default
    rax25kb.cfg.

-q, --quiet

    Suppress startup banner and configuration display. Errors and log
    messages are still displayed according to the log level.

-h, --help

    Display help message and exit.

CONFIGURATION FILE

The configuration file rax25kb.cfg uses a simple key=value format.
Values may be enclosed in double quotes. Lines beginning with # are
comments.

Configuration Options

serial_port

    Serial port device path (required).

baud_rate

    Serial port baud rate. Default: 9600.

stop_bits

    Number of stop bits. Values: 1, 2, one, two. KISS TNC default: 1.

parity

    Parity checking. Values: none, n, no, even, e, odd, o. KISS TNC
    default: none.

flow_control

    Serial port flow control. Values: none, software, hardware, dtrdsr.
    Alternative spellings accepted: xon, xonxoff, xon-xoff, rtscts,
    rts-cts, rts/cts, dtr-dsr, dtr/dsr. Default: none.

tcp_address

    TCP listener address(es), space or comma separated. Default:
    0.0.0.0.

tcp_port

    TCP listener port. Default: 8001.

phil_flag

    Enable PhilFlag correction. Values: 0, 1, true, false, yes, no.
    Default: 0.

dump

    Enable frame dumping. Values: 0, 1, true, false, yes, no.
    Default: 0.

parse_kiss

    Enable KISS frame parsing. Values: 0, 1, true, false, yes, no.
    Default: 0.

dump_ax25

    Enable AX.25 info field dumping. Values: 0, 1, true, false, yes, no.
    Default: 0.

raw_copy

    Enable raw copy mode (transparent pass-through). When enabled, all
    data is copied bidirectionally without KISS frame processing.
    Values: 0, 1, true, false, yes, no. Default: 0.

log_level

    Logging level (0-9). Default: 5.

logfile

    Log file path.

pidfile

    PID file path.

pcap_file

    PCAP output file path.

Example Configuration File

    # rax25kb.cfg - KISS TNC Bridge Configuration
    serial_port=/dev/ttyUSB0
    baud_rate=9600
    stop_bits=1
    parity=none
    flow_control=none

    tcp_address="0.0.0.0 ::"
    tcp_port=8001

    phil_flag=1
    parse_kiss=1
    log_level=6

    logfile=/var/log/rax25kb.log
    pidfile=/var/run/rax25kb.pid
    pcap_file=/var/log/rax25kb.pcap

LOG LEVELS

0 - EMERG

    System is unusable.

1 - ALERT

    Action must be taken immediately.

2 - CRIT

    Critical conditions.

3 - ERROR

    Error conditions.

4 - WARN

    Warning conditions.

5 - NOTICE

    Normal but significant condition (default).

6 - INFO

    Informational messages.

7 - DEBUG

    Debug-level messages.

8 - TRACE

    Detailed trace messages.

9 - VERBOSE

    Maximum verbosity.

SIGNALS

SIGINT

    Graceful shutdown. The application catches Ctrl+C (SIGINT) and exits
    cleanly.

EXAMPLES

Basic Usage

    # Start with default configuration (8N1, no flow control)
    rax25kb

    # Use specific serial port and baud rate
    rax25kb -D /dev/ttyUSB0 -b 19200

    # Set serial parameters: 8E1 with hardware flow control
    rax25kb -D /dev/ttyUSB0 -b 9600 -Q even -s 1 -H

    # Listen on localhost only with KISS parsing
    rax25kb -I 127.0.0.1 -p 8001 -k

Advanced Usage

    # Full featured setup with PCAP capture and hardware flow control
    rax25kb -D /dev/ttyUSB0 -b 9600 -H \
            -I "0.0.0.0 ::" -p 8001 \
            -k -a --pcap /var/log/packets.pcap \
            -l /var/log/rax25kb.log -L 7

    # Hardware with PhilFlag correction and odd parity
    rax25kb -D /dev/ttyUSB0 -Q odd -n -k

    # Software flow control for older equipment
    rax25kb -D /dev/ttyUSB0 -b 1200 -x -s 2

    # IPv6 only on specific address
    rax25kb -6 -I "2001:db8::1" -p 8001

    # Quiet mode with custom config
    rax25kb -c /etc/rax25kb/custom.cfg -q

Windows Usage

    # Windows with COM port (8N1 default)
    rax25kb.exe -D COM3 -b 9600 -k

    # With DTR/DSR flow control
    rax25kb.exe -D COM3 --dtr-dsr

    # With log file
    rax25kb.exe -D COM3 -l C:\ProgramData\rax25kb\log.txt

FILES

rax25kb.cfg

    Default configuration file in the current directory.

/var/log/rax25kb.log

    Common location for log files on Unix systems.

/var/run/rax25kb.pid

    Common location for PID files on Unix systems.

EXIT STATUS

0

    Successful termination (including SIGINT).

1

    Configuration error, unable to open serial port, or unable to bind
    to TCP address.

COMPATIBILITY

Operating Systems

rax25kb runs on:

  -   Linux

  -   Windows

  -   macOS

  -   Other Unix-like systems with serial port support

KISS Protocol

Implements KISS protocol as defined in the ARRL specification with the
following frame types:

  -   Data frames (command 0)

  -   TXDELAY (command 1)

  -   Persistence (command 2)

  -   SlotTime (command 3)

  -   TXtail (command 4)

  -   FullDuplex (command 5)

  -   SetHardware (command 6)

  -   Return (command 15)

AX.25 Protocol

Parses AX.25 frames and identifies:

  -   I-frames (Information - connected mode)

  -   S-frames (Supervisory - connected mode)

  -   U-frames (Unnumbered control)

  -   UI-frames (Unnumbered Information - unconnected mode, used by
      APRS)

NOTES

KISS TNC Default Settings

Standard KISS TNCs use 8N1 serial format (8 data bits, No parity, 1 stop
bit) with no flow control. The application defaults match these
settings. Adjust only if your hardware requires different parameters.

PhilFlag Correction

The PhilFlag option corrects two issues found in some TNCs with TASCO
modem chipsets:

Serial to TCP (Receive)

    Corrects improperly escaped FEND bytes (0xC0) that appear unescaped
    within KISS frame data. These are automatically converted to the
    proper escape sequence (0xDB 0xDC). This fixes the TASCO modem
    chipset bug where raw AX.25 frames are not properly converted to
    KISS format.

TCP to Serial (Transmit)

    Escapes 'C' (0x43) and 'c' (0x63) characters as the sequences (0xDB
    0x43) and (0xDB 0x63) to prevent the radio from misinterpreting
    "TC0\n" or "tc0\n" as command sequences. This prevents unintended
    mode changes or radio resets.

The PhilFlag correction is bidirectional but applies different
transformations in each direction. This is a workaround for
non-compliant hardware and should only be enabled when necessary. As the
saying goes: "In for drought? No, we are in for turbo-hydrometeorology!"

PCAP Format

PCAP files use data link type 147 (USER0) to store raw AX.25 frames.
These can be analyzed in Wireshark with appropriate dissectors. Only
KISS data frames (command 0) are captured; control frames are ignored.

Multiple TCP Addresses

When multiple TCP addresses are specified, the application listens on
all of them simultaneously. Each address can accept one client
connection at a time. Connections are handled sequentially; the
application accepts a new connection only after the previous one closes.

Serial Port Permissions

On Unix systems, the user must have read/write permissions to the serial
port device. This typically requires membership in the dialout or uucp
group:

    sudo usermod -a -G dialout $USER

BUGS

Report bugs to the project repository or maintainer.

Known limitations:

-   Only one TCP client connection is handled at a time per listener

-   No SSL/TLS support for TCP connections

-   PCAP timestamps use system time, not packet arrival time

SEE ALSO

kissattach(8), ax25(4), aprx(8), direwolf(1)

AX.25 Protocol Specification: https://www.tapr.org/pdf/AX25.2.2.pdf
KISS Protocol Specification: https://www.ax25.net/kiss.aspx

AUTHOR

Written for the amateur radio community.

COPYRIGHT

This is free software; see the source for copying conditions.
